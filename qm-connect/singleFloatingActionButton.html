<meta charset="utf-8" />
<input type="button" id="qm-connectv3-button" value="" onclick="QuantiModoIntegration.qmSetupIonicPopupIframe('import')"
       style="background:url(https://local.quantimo.do/qm-connect/connect.png) no-repeat; cursor:pointer; width:385px; height:74px; border:none;">
<script src="https://local.quantimo.do/api/v1/integration.js?clientId=quantimodo&showButton=true"></script>
<script>
    window.QuantiModoIntegration.options = {
        clientUserId: encodeURIComponent('230'),
        clientId: 'medimodo',
        publicToken: (localStorage.getItem('publicToken')) ? localStorage.getItem('publicToken') : null,
        fullscreen: true,
        showButton: true,
        defaultState: 'import',
        hideMenu: false,
        apiUrl: 'local.quantimo.do',
        clientServerFinishUrl: "https://local.quantimo.do/api/v1/quantimodo/finish",
        finish: function(sessionTokenObject) {
            console.error('You have not defined window.QuantiModoIntegration.options.finish!');
            console.warn("window.QuantiModoIntegration.options.finish is called after user finishes connecting their health data.");
            console.warn("You should set this to POST sessionTokenObject as-is to your server for step 2");
            console.warn("Also, include code here to refresh the page.");
            localStorage.setItem('publicToken', sessionTokenObject.publicToken);
        },
        close: function() {
            /* (optional) Called when a user closes the popup without connecting any data sources */
        },
        error: function(err) {
            console.error(err);
            /* (optional) Called if an error occurs when loading the popup. */
        }
    };
    window.QuantiModoIntegration.createSingleFloatingActionButton();
</script>